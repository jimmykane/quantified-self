<mat-toolbar class="mat-nav-list">
  <mat-toolbar-row class="mat-elevation-z0 mat-list-item mat-app-background" (click)="sideNav.close();">
    <mat-icon class="app-icon" svgIcon="logo"></mat-icon>
    Quantified Self &nbsp;
    <span style="font-size: 0.6em;">{{appVersion}}</span>
  </mat-toolbar-row>
</mat-toolbar>

<mat-nav-list>
  <!-- User Profile Section (when logged in) -->
  @if (user) {
  <div class="sidenav-profile" routerLink="/settings" (click)="sideNav.close();">
    <div class="sidenav-avatar"
      [style.backgroundImage]="'url('+ ($any(user).photoURL ? $any(user).photoURL : 'https://ui-avatars.com/api/?name=' + (user.displayName || 'User')) +')'">
    </div>
    <div class="sidenav-user-info">
      <span class="sidenav-user-name">{{ user.displayName || 'Welcome!' }}</span>
      <span class="sidenav-user-email">{{ $any(user).email }}</span>
      @if (isProUser) {
      <span class="sidenav-pro-badge">
        <mat-icon>verified</mat-icon>
        PRO
      </span>
      } @else if (isBasicUser) {
      <span class="sidenav-basic-badge">
        <mat-icon>verified</mat-icon>
        BASIC
      </span>
      }
    </div>
  </div>
  }

  <!-- Navigation Section -->
  <div class="sidenav-section-header">Navigation</div>

  @if (!user) {
  <mat-list-item routerLinkActive="active" routerLink="/" (click)="sideNav.close();">
    <mat-icon>home</mat-icon>
    <span>Home</span>
  </mat-list-item>
  }

  @if (user) {
  <mat-list-item routerLinkActive="active" routerLink="/dashboard" (click)="sideNav.close();">
    <mat-icon>dashboard</mat-icon>
    <span>Dashboard</span>
  </mat-list-item>
  }

  @if (!user) {
  <mat-list-item routerLinkActive="active" routerLink="/login" (click)="sideNav.close();">
    <mat-icon>assignment_ind</mat-icon>
    <span>Login</span>
  </mat-list-item>
  }

  @if (user) {
  <mat-list-item routerLinkActive="active" [routerLink]="hasPaidAccess ? '/mytracks' : '/pricing'"
    (click)="sideNav.close();">
    <mat-icon svgIcon="heat-map"></mat-icon>
    <span>My Tracks <span class="mat-small">(Beta)</span></span>
    <span class="fill-space"></span>
    @if (!hasPaidAccess) {
    <mat-icon class="lock-icon">lock</mat-icon>
    <span class="pro-badge">PRO</span>
    }
  </mat-list-item>
  }



  <!-- Account Section -->
  @if (user) {
  <div class="sidenav-section-header">Account</div>
  }

  <mat-list-item routerLinkActive="active" routerLink="/services" (click)="sideNav.close();">
    <mat-icon>leak_add</mat-icon>
    <span>Services</span>
  </mat-list-item>

  @if (user) {
  <mat-list-item routerLinkActive="active" [routerLink]="'/settings'" (click)="sideNav.close();">
    <mat-icon>settings</mat-icon>
    <span>Settings</span>
  </mat-list-item>

  <mat-list-item routerLinkActive="active" routerLink="/pricing" (click)="sideNav.close();">
    <mat-icon>card_membership</mat-icon>
    <span>Subscription</span>
  </mat-list-item>

  @if (isAdminUser) {
  <mat-list-item routerLinkActive="active" routerLink="/admin" (click)="sideNav.close();">
    <mat-icon>admin_panel_settings</mat-icon>
    <span>Admin</span>
  </mat-list-item>
  }
  }

  <!-- Preferences Section -->
  <div class="sidenav-section-header">Preferences</div>

  <mat-list-item (click)="$event.stopPropagation(); $event.preventDefault(); themeService.toggleTheme($event)">
    <mat-icon svgIcon="dark-mode"></mat-icon>
    <span>Dark theme</span>
    <span class="fill-space"></span>
    <mat-slide-toggle [disabled]="!appTheme" [color]="'accent'" [checked]="appTheme === appThemes.Dark">
    </mat-slide-toggle>
  </mat-list-item>

  <!-- Support Section -->
  <div class="sidenav-section-header">Support</div>



  <mat-list-item (click)="gitHubStar()">
    <mat-icon>star</mat-icon>
    <span>Star on GitHub</span><span class="fill-space"></span>
    <mat-icon>open_in_new</mat-icon>
  </mat-list-item>

  <mat-list-item onclick="window.open('mailto:support@quantified-self.io')">
    <mat-icon>email</mat-icon>
    <span>Contact</span><span class="fill-space"></span>
    <mat-icon>open_in_new</mat-icon>
  </mat-list-item>

  <mat-list-item onclick="window.open('https://github.com/jimmykane/quantified-self/issues')">
    <mat-icon>bug_report</mat-icon>
    <span>File a bug</span><span class="fill-space"></span>
    <mat-icon>open_in_new</mat-icon>
  </mat-list-item>

  <!-- Legal Section -->
  <div class="sidenav-section-header">Legal</div>

  <mat-list-item routerLink="/policies" (click)="sideNav.close();">
    <mat-icon>policy</mat-icon>
    <span>Policies</span>
  </mat-list-item>

  <!-- Logout -->
  @if (user) {
  <mat-divider></mat-divider>

  <mat-list-item (click)="logout()">
    <mat-icon>power_settings_new</mat-icon>
    <span>Logout</span>
  </mat-list-item>
  }

</mat-nav-list>