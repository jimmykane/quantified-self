<div class="glass-card event-summary-card">
  <!-- Primary Info Section -->
  <div class="summary-primary-info performance-header">
    <!-- Left: Identity & Metadata -->
    <div class="identity-section">
      <div class="activity-icon-container" (click)="toggleEventPrivacy()">
        <app-activity-type-icon class="activity-main-icon" [activityType]="mainActivityType" size="32px"
          [matTooltip]="'Event is ' + event.privacy"></app-activity-type-icon>
        <div class="privacy-mini-wrapper">
          <app-privacy-icon [privacy]="event.privacy"></app-privacy-icon>
        </div>
      </div>
      <div class="text-stack">
        <div class="top-meta">
          <span class="date"><b>{{ event.startDate | date:"d MMM yyyy" }}</b></span>
          <span class="time-separator">at</span>
          <span class="time">{{ event.startDate | date:"shortTime" }}</span>
        </div>
        <div class="chips-row">
          <span class="chip activity-chip">{{ mainActivityType }}</span>
          @if (feelingEmoji) {
          <span class="chip feeling-chip" [matTooltip]="'Feeling: ' + feelingLabel">{{ feelingEmoji }}</span>
          }
          @if (rpe) {
          <span class="chip rpe-chip" [matTooltip]="'RPE: ' + rpeLabel">RPE {{ rpe }}</span>
          }
        </div>
      </div>
    </div>

    <!-- Center: Hero Metrics -->
    <div class="hero-metrics">
      @for (stat of getHeroStats(); track stat) {
      <div class="metric-item">
        <span class="value">{{ getStatValue(stat) }}</span>
        <span class="unit">{{ getStatUnit(stat) }}</span>
      </div>
      }
    </div>

    <!-- Right: Actions -->
    <div class="summary-actions">
      @if (hasDevices) {
      <button mat-icon-button (click)="openDevices()" matTooltip="View devices">
        <mat-icon>devices</mat-icon>
      </button>
      }
      @if (isOwner) {
      <button mat-icon-button (click)="openEditDetails()" matTooltip="Edit details">
        <mat-icon>edit</mat-icon>
      </button>
      <app-event-actions [user]="user" [event]="event" [showDownloadOriginal]="true" align="end"></app-event-actions>
      }
    </div>
  </div>

  <!-- Activities Toggles Section -->
  @if (event.getActivities().length > 1) {
  <div class="summary-activities-toggles">
    <app-activities-toggles [event]="event" [user]="user" [isOwner]="isOwner" [selectedActivities]="selectedActivities">
    </app-activities-toggles>
  </div>
  }

  <!-- Stats Grid Section -->
  <div class="summary-stats-area">
    <div class="stats-container">
      <app-event-card-stats-grid [event]="event" [selectedActivities]="selectedActivities"
        [unitSettings]="unitSettings">
        <div stats-suffix class="stat-item show-more-item" (click)="openDetailedStats()"
          matTooltip="Show more statistics">
          <div class="stat-avatar">
            <mat-icon [style.width.px]="20" [style.height.px]="20"
              [style.font-size.px]="20">keyboard_double_arrow_down</mat-icon>
          </div>
          <div class="stat-content">
            <div class="stat-label">Show</div>
            <div class="stat-value-grid">More</div>
          </div>
        </div>
      </app-event-card-stats-grid>
    </div>

    <ng-content select="[after-stats]"></ng-content>
  </div>

  <!-- Projected Content (Tabs, etc.) -->
  <mat-divider></mat-divider>
  <ng-content select="[summary-bottom]"></ng-content>
</div>