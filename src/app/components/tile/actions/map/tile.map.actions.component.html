<button mat-icon-button [matMenuTriggerFor]="menu"
  (click)="$event.preventDefault(); $event.stopPropagation(); fixDisappearIOSBug();">
  <mat-icon>more_vert</mat-icon>
</button>
<mat-menu #menu="matMenu" class="qs-config-menu">
  @if (user.settings.dashboardSettings.tiles.length <= 11) { <app-tile-actions-header (add)="addNewTile($event)">
    </app-tile-actions-header>
    }
    <section mat-menu-item>
      <mat-form-field>
        <mat-label>Type {{type}}</mat-label>
        <mat-select placeholder="Type of tile" [value]="type" (selectionChange)="changeTileType($event)">
          <mat-select-trigger>
            @if (type === tileTypes.Map) {
            <span>
              <mat-icon>map</mat-icon>&nbsp;{{tileTypes.Map}}
            </span>
            }
            @if (type === tileTypes.Chart) {
            <span>
              <mat-icon>show_chart</mat-icon>&nbsp;{{tileTypes.Chart}}
            </span>
            }
          </mat-select-trigger>
          @for (tileType of tileTypes | keyvalue; track tileType) {
          <mat-option [value]="tileType.value">
            @if (tileType.key === tileTypes.Map) {
            <mat-icon>map</mat-icon>
            }
            @if (tileType.key === tileTypes.Chart) {
            <mat-icon>show_chart</mat-icon>
            }
            {{tileType.value}}
          </mat-option>
          }
        </mat-select>
      </mat-form-field>
    </section>
    <section mat-menu-item>
      <mat-form-field>
        <mat-label>Map Type</mat-label>
        <mat-select placeholder="Map type" [value]="mapType" (selectionChange)="changeMapType($event)">
          @for (mapType of mapTypes | keyvalue; track mapType) {
          <mat-option [value]="mapType.value">
            {{mapType.key}}
          </mat-option>
          }
        </mat-select>
      </mat-form-field>
    </section>


    <section mat-menu-item>
      <mat-form-field>
        <mat-label>Column Size</mat-label>
        <mat-select placeholder="Size" [value]="size.columns" (selectionChange)="changeTileColumnSize($event)">
          <section>
            <mat-option [value]="1">
              Single
            </mat-option>
            <mat-option [value]="2">
              Double
            </mat-option>
            <mat-option [value]="3">
              Triple
            </mat-option>
            <mat-option [value]="4">
              Quad
            </mat-option>
          </section>
        </mat-select>
      </mat-form-field>
    </section>
    <section mat-menu-item>
      <mat-form-field>
        <mat-label>Row Size</mat-label>
        <mat-select placeholder="Size" [value]="size.rows" (selectionChange)="changeTileRowSize($event)">
          <section>
            <mat-option [value]="1">
              Single
            </mat-option>
            <mat-option [value]="2">
              Double
            </mat-option>
            <mat-option [value]="3">
              Triple
            </mat-option>
            <mat-option [value]="4">
              Quad
            </mat-option>
          </section>
        </mat-select>
      </mat-form-field>
    </section>


    <section mat-menu-item>
      <mat-slide-toggle [color]="'accent'" (change)="switchClusterMarkers($event)" [(ngModel)]="clusterMarkers">
        <span matTooltip="If you want clusters of markers">
          Clusters
        </span>
      </mat-slide-toggle>
    </section>


    @if (user.settings.dashboardSettings.tiles.length > 1) {
    <app-tile-actions-footer (delete)="deleteTile($event)"></app-tile-actions-footer>
    }
</mat-menu>